<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NuroBot | Digital Twin</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="icon" href="favicon.jpeg" type="image/x-icon">
    <style>
        /* --- CSS STYLES --- */
        :root {
            --bg: #09090b;
            --surface: #18181b;
            --primary: #00F0FF;
            --secondary: #7c3aed;
            --text: #e4e4e7;
            --border: #27272a;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body { 
            background: var(--bg); color: var(--text); 
            font-family: 'Segoe UI', sans-serif; overflow: hidden; 
        }

        /* Navbar */
        .global-nav {
            background-color: rgba(22, 22, 23, 0.95); width: 100%; height: 50px;
            display: flex; justify-content: center; align-items: center; top: 0;
            font-size: 14px; position: sticky; z-index: 999;
            border-bottom: 1px solid var(--border);
        }
        .nav-content {
            display: flex; justify-content: space-between; align-items: center;
            width: 100%; max-width: 1080px; padding: 0 20px;
        }
        .list-item { list-style: none; cursor: pointer; }
        .list-item a {
            text-decoration: none; color: #a1a1aa; padding: 8px 12px;
            transition: all 0.2s; border-radius: 6px; font-weight: 500;
        }
        .list-item a:hover, .list-item a.active { color: #fff; background: rgba(255,255,255,0.1); }
        .brand { color: var(--primary) !important; font-weight: bold; letter-spacing: 1px; }

        /* Layout */
        .layout-grid {
            display: grid; grid-template-columns: 45% 55%; 
            height: calc(100vh - 50px); width: 100vw;
        }

        /* Left: 3D Stage */
        .robot-stage {
            position: relative;
            background: radial-gradient(circle at center, #27272a 0%, #09090b 100%);
            border-right: 1px solid var(--border);
            overflow: hidden; /* Ensures no scrollbars on the stage */
        }
        #three-canvas-container { width: 100%; height: 100%; display: block; }
        
        .status-overlay {
            position: absolute; top: 20px; left: 20px;
            background: rgba(0,0,0,0.6); padding: 8px 16px; border-radius: 20px; 
            border: 1px solid #333; backdrop-filter: blur(5px); 
            font-family: monospace; font-size: 12px; display: flex; align-items: center; gap: 8px;
        }
        .health-score-overlay {
            position: absolute; bottom: 30px; right: 30px; text-align: right; pointer-events: none;
        }
        .health-number { font-size: 4rem; font-weight: bold; color: var(--primary); line-height: 1; text-shadow: 0 0 20px rgba(0,240,255,0.3); }
        .health-label { font-size: 0.8rem; color: #a1a1aa; letter-spacing: 2px; }

        /* Right: Dashboard Pages */
        .dashboard-content { 
            overflow-y: auto; padding: 40px; background: var(--bg); position: relative;
        }
        .page-section { display: none; animation: fadeIn 0.4s ease; }
        .page-section.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Typography & Cards */
        h1 { font-size: 2rem; margin-bottom: 10px; }
        h2 { font-size: 1.2rem; color: #a1a1aa; margin-bottom: 20px; font-weight: 400; border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        p { color: #a1a1aa; line-height: 1.6; margin-bottom: 20px; }

        .card-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .card {
            background: var(--surface); border: 1px solid var(--border); 
            border-radius: 12px; padding: 20px; text-align: center;
        }
        .card .value { font-size: 2.2rem; font-weight: bold; color: #fff; margin: 10px 0; }
        
        /* Analytics Charts Grid */
        .charts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .chart-box { background: var(--surface); padding: 15px; border-radius: 12px; border: 1px solid var(--border); }

        /* AI Box */
        .ai-panel {
            background: rgba(16, 185, 129, 0.05); border: 1px solid var(--success);
            border-radius: 12px; padding: 20px; margin-top: 20px;
        }
        .ai-list { list-style: none; margin-top: 10px; }
        .ai-list li { 
            padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); 
            display: flex; gap: 10px; align-items: flex-start;
        }
        .ai-list li:last-child { border-bottom: none; }

        /* Profile Form */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; color: #a1a1aa; margin-bottom: 5px; font-size: 0.9rem; }
        .input-group input { 
            width: 100%; background: #000; border: 1px solid var(--border); 
            color: #fff; padding: 10px; border-radius: 6px;
        }

        /* Button */
        .btn-connect {
            background: var(--primary); color: #000; border: none;
            padding: 10px 24px; border-radius: 30px; cursor: pointer; 
            font-weight: bold; text-transform: uppercase; letter-spacing: 1px;
            transition: transform 0.2s; display: inline-block;
        }
        .btn-connect:hover { transform: scale(1.05); box-shadow: 0 0 15px var(--primary); }
        .disclaimer { font-size: 0.75rem; color: #666; margin-top: 8px; font-style: italic; }

        /* --- MOBILE RESPONSIVENESS --- */
        @media (max-width: 900px) {
            .layout-grid {
                grid-template-columns: 1fr;
                /* Robot gets 45% height, Dashboard gets rest. Fixed scrolling. */
                grid-template-rows: 45vh 1fr; 
                height: 100vh;
                overflow: hidden; 
            }

            .robot-stage {
                border-right: none;
                border-bottom: 1px solid var(--border);
                width: 100%;
            }

            .dashboard-content {
                padding: 20px;
                overflow-y: scroll; /* Allow scrolling inside this panel */
                height: 100%;
                padding-bottom: 100px; /* Extra padding for bottom scroll */
            }

            /* Navbar scrollable on mobile */
            .nav-content {
                padding: 0 15px;
                justify-content: flex-start;
                gap: 20px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            .nav-content::-webkit-scrollbar { display: none; }
            .list-item { white-space: nowrap; }

            /* Grid Adjustments */
            .card-row { grid-template-columns: 1fr; gap: 15px; }
            .charts-grid { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
            
            h1 { font-size: 1.5rem; }
            .health-number { font-size: 3rem; }
        }
    </style>
</head>

<body>
    <nav class="global-nav">
        <ul class="nav-content">
            <li class="list-item" style="font-size: 21px;"><a href="#" class="brand">NuroTwin</a></li>
            <li class="list-item"><a href="#" onclick="navTo('dashboard')" class="active" id="nav-dashboard">Dashboard</a></li>
            <li class="list-item"><a href="#" onclick="navTo('bio')" id="nav-bio">Bio-Metrics</a></li>
            <li class="list-item"><a href="#" onclick="navTo('analytics')" id="nav-analytics">Analytics</a></li>
            <li class="list-item"><a href="#" onclick="navTo('ai')" id="nav-ai">AI Diagnostics</a></li>
            <li class="list-item"><a href="#" onclick="navTo('profile')" id="nav-profile">Profile</a></li>
        </ul>
    </nav>

    <div class="layout-grid">
        
        <div class="robot-stage">
            <div id="three-canvas-container"></div>
            
            <div class="status-overlay">
                <span id="hw-dot" style="width: 8px; height: 8px; background: #555; border-radius: 50%;"></span>
                <span id="hw-text" style="color: #888;">STANDBY</span>
            </div>

            <div class="health-score-overlay">
                <div class="health-number" id="val-health">--</div>
                <div class="health-label">HEALTH SCORE</div>
            </div>
        </div>

        <div class="dashboard-content">
            <div id="page-dashboard" class="page-section active">
                <h1>Cognitive Health Twin</h1>
                <p>Real-time digital interface monitoring physiological data via ESP32 sensors.</p>
                <button class="btn-connect" onclick="toggleDemoMode()" id="btn-main">Connect Hardware</button>
                <div id="demo-disclaimer" class="disclaimer" style="opacity:0;">* Demo Mode: Simulating sensor data stream.</div>
                <div style="margin-top: 30px;">
                    <h2>Live Vitals</h2>
                    <div class="card-row">
                        <div class="card" id="card-bpm">
                            <h3>Heart Rate</h3>
                            <div class="value"><span id="dash-bpm">--</span></div>
                            <small>BPM</small>
                        </div>
                        <div class="card" id="card-spo2">
                            <h3>Oxygen</h3>
                            <div class="value"><span id="dash-spo2">--</span></div>
                            <small>%</small>
                        </div>
                        <div class="card" id="card-temp">
                            <h3>Temp</h3>
                            <div class="value"><span id="dash-temp">--</span></div>
                            <small>Â°C</small>
                        </div>
                    </div>
                    <div class="ai-panel" id="dashboard-ai-box">
                        <i class="fas fa-robot"></i> <b>AI Insight:</b> System standby. Connect hardware to begin analysis.
                    </div>
                </div>
            </div>

            <div id="page-bio" class="page-section">
                <h1>Bio-Metrics Detail</h1>
                <div class="chart-box" style="height: 250px; margin-bottom: 20px;">
                    <canvas id="chart-bpm-detail"></canvas>
                </div>
                <div class="charts-grid">
                    <div class="chart-box"><canvas id="chart-spo2-detail"></canvas></div>
                    <div class="chart-box"><canvas id="chart-temp-detail"></canvas></div>
                </div>
            </div>

            <div id="page-analytics" class="page-section">
                <h1>Historical Analytics</h1>
                <div class="charts-grid">
                    <div class="chart-box"><h4>Sleep Quality</h4><canvas id="chart-sleep"></canvas></div>
                    <div class="chart-box"><h4>Stress Levels</h4><canvas id="chart-stress"></canvas></div>
                </div>
                <div class="chart-box" style="margin-top:20px;"><h4>Weight Tracker</h4><canvas id="chart-weight"></canvas></div>
            </div>

            <div id="page-ai" class="page-section">
                <h1>AI Diagnostics</h1>
                <div class="ai-panel" style="background: var(--surface); border: 1px solid var(--border);">
                    <ul class="ai-list" id="full-ai-list"><li>Waiting for data stream...</li></ul>
                </div>
            </div>

            <div id="page-profile" class="page-section">
                <h1>User Profile</h1>
                <div class="form-grid">
                    <div class="input-group"><label>Full Name</label><input type="text" value="Demo User" readonly></div>
                    <div class="input-group"><label>Age</label><input type="number" value="28"></div>
                    <div class="input-group"><label>Height (cm)</label><input type="number" value="175"></div>
                    <div class="input-group"><label>Weight (kg)</label><input type="number" value="70"></div>
                </div>
                <button class="btn-connect" style="font-size:0.8rem;">Save Changes</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- GLOBAL VARIABLES ---
            const state = { bpm: 0, spo2: 0, temp: 0, healthScore: 100 };
            const mouse = { x: 0, y: 0 };
            
            let robot, eyeL, eyeR, head;
            let isDemoActive = false;
            let simInterval;
            
            const clock = new THREE.Clock();
            const container = document.getElementById('three-canvas-container');
            let charts = {};
            let camera, renderer;

            // --- INIT ---
            initThreeJS();
            initCharts();
            animate();

            // --- 1. THREE.JS SETUP ---
            function initThreeJS() {
                const scene = new THREE.Scene();
                // Renderer
                renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                renderer.setSize(container.clientWidth, container.clientHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.outputEncoding = THREE.sRGBEncoding;
                renderer.shadowMap.enabled = true;
                container.appendChild(renderer.domElement);

                // Camera
                camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 100);
                
                // --- FIXED: AUTO-CENTERING CAMERA ---
                adjustCameraPosition();

                // Lighting
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                scene.add(ambientLight);
                const keyLight = new THREE.DirectionalLight(0xffffff, 1.5);
                keyLight.position.set(5, 5, 5);
                keyLight.castShadow = true;
                scene.add(keyLight);
                const backLight = new THREE.SpotLight(0x00F0FF, 5);
                backLight.position.set(-5, 5, -5);
                scene.add(backLight);

                // --- LOAD ROBOT (Original GLTFLoader Code) ---
                const loader = new THREE.GLTFLoader();

                try {
                    loader.load('Robot.glb', (gltf) => {
                        robot = gltf.scene;
                        scene.add(robot);
                        robot.position.y = -1.0;
                        robot.rotation.y = Math.PI; 

                        eyeL = robot.getObjectByName('Eye_L');
                        eyeR = robot.getObjectByName('Eye_R');
                        head = robot.getObjectByName('Head');
                        
                        robot.traverse(o => { if (o.isMesh) { o.castShadow = true; o.receiveShadow = true; } });
                    }, undefined, (e) => {
                        console.warn("GLB Load Failed. Using Fallback.");
                        createProceduralRobot();
                    });
                } catch (e) { createProceduralRobot(); }

                // --- HELPER: FALLBACK ROBOT ---
                function createProceduralRobot() {
                    if(robot) return;
                    const group = new THREE.Group();
                    const mat = new THREE.MeshStandardMaterial({color: 0xcccccc});
                    const eyeMat = new THREE.MeshBasicMaterial({color: 0x00F0FF});
                    
                    head = new THREE.Group(); head.position.y = 1.0; group.add(head);
                    head.add(new THREE.Mesh(new THREE.BoxGeometry(1.2, 1, 1), mat));
                    head.name = "Head";
                    
                    eyeL = new THREE.Mesh(new THREE.SphereGeometry(0.15), eyeMat);
                    eyeL.position.set(-0.3, 0.1, 0.5); head.add(eyeL);
                    eyeR = new THREE.Mesh(new THREE.SphereGeometry(0.15), eyeMat);
                    eyeR.position.set(0.3, 0.1, 0.5); head.add(eyeR);
                    
                    const body = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.5, 1.2, 32), mat);
                    body.position.y = 0; group.add(body);
                    
                    scene.add(group);
                    robot = group;
                    robot.position.y = -1.0;
                }

                // --- INPUT EVENTS ---
                
                // MOUSE MOVEMENT
                document.addEventListener('mousemove', (e) => {
                    updateInput(e.clientX, e.clientY);
                });

                // TOUCH MOVEMENT (For Mobile)
                document.addEventListener('touchmove', (e) => {
                    if(e.touches.length > 0) {
                        // Optional: prevent scroll if touching the robot stage specifically
                        // if(e.target.closest('.robot-stage')) e.preventDefault();
                        updateInput(e.touches[0].clientX, e.touches[0].clientY);
                    }
                }, { passive: false });

                function updateInput(x, y) {
                    const rect = container.getBoundingClientRect();
                    // Check if input is roughly within the canvas area
                    if(x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
                        const canvasX = x - rect.left;
                        const canvasY = y - rect.top;
                        mouse.x = (canvasX / rect.width) * 2 - 1;
                        mouse.y = -(canvasY / rect.height) * 2 + 1;
                    }
                }

                // --- RESIZE HANDLER ---
                window.addEventListener('resize', () => {
                    renderer.setSize(container.clientWidth, container.clientHeight);
                    camera.aspect = container.clientWidth / container.clientHeight;
                    camera.updateProjectionMatrix();
                    adjustCameraPosition(); // Re-check camera position on resize
                });

                // --- ANIMATION LOOP ---
                window.animate = function() {
                    requestAnimationFrame(animate);
                    const time = clock.getElapsedTime();

                    if (robot) {
                        const score = state.healthScore;
                        const speed = score < 80 ? 8 : 2; 
                        const amp = score < 50 ? 0.02 : 0.05; 
                        const baseY = score < 50 ? -1.2 : -1.0;
                        
                        robot.position.y = THREE.MathUtils.lerp(robot.position.y, baseY + Math.sin(time * speed) * amp, 0.1);

                        if (eyeL && eyeR) {
                            let tx = Math.max(-0.7, Math.min(0.7, mouse.x * 0.5));
                            let ty = Math.max(-0.5, Math.min(0.5, mouse.y * 0.5));
                            
                            eyeL.rotation.y = THREE.MathUtils.lerp(eyeL.rotation.y, tx, 0.1);
                            eyeL.rotation.x = THREE.MathUtils.lerp(eyeL.rotation.x, ty, 0.1);
                            eyeR.rotation.y = THREE.MathUtils.lerp(eyeR.rotation.y, tx, 0.1);
                            eyeR.rotation.x = THREE.MathUtils.lerp(eyeR.rotation.x, ty, 0.1);

                            if(head) {
                                head.rotation.y = THREE.MathUtils.lerp(head.rotation.y, tx * 0.5, 0.05);
                                head.rotation.x = THREE.MathUtils.lerp(head.rotation.x, ty * 0.5, 0.05);
                            }
                        }
                    }
                    renderer.render(scene, camera);
                }
            }

            // --- FUNCTION: Adjust Camera for Mobile ---
            function adjustCameraPosition() {
                if (!camera) return;
                const aspect = container.clientWidth / container.clientHeight;
                
                if (window.innerWidth < 900) {
                    // MOBILE: Move camera BACK so robot fits in the narrow screen
                    // If aspect ratio is very narrow (portrait), move even further back
                    const dist = aspect < 0.6 ? 9 : 7; 
                    camera.position.set(0, 0, dist);
                    camera.lookAt(0, -0.5, 0); // Look slightly down at robot center
                } else {
                    // DESKTOP: Standard position
                    camera.position.set(0, 0.5, 5);
                    camera.lookAt(0, 0, 0);
                }
            }

            // --- 2. DASHBOARD LOGIC ---
            window.navTo = function(pageId) {
                document.querySelectorAll('.list-item a').forEach(el => el.classList.remove('active'));
                const link = document.getElementById('nav-' + pageId);
                if(link) link.classList.add('active');
                document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));
                document.getElementById('page-' + pageId).classList.add('active');
            }

            // --- 3. DEMO LOGIC ---
            window.toggleDemoMode = function() {
                const btn = document.getElementById('btn-main');
                const hwText = document.getElementById('hw-text');
                const hwDot = document.getElementById('hw-dot');
                const disclaimer = document.getElementById('demo-disclaimer');

                isDemoActive = !isDemoActive;

                if (isDemoActive) {
                    btn.innerText = "Hardware Connected";
                    btn.style.background = "var(--success)";
                    btn.style.color = "#fff";
                    hwText.innerText = "ONLINE"; hwText.style.color = "var(--success)";
                    hwDot.style.background = "var(--success)"; hwDot.style.boxShadow = "0 0 10px var(--success)";
                    disclaimer.style.opacity = 1;
                    simInterval = setInterval(runSimulationStep, 2000);
                    runSimulationStep(); 
                } else {
                    clearInterval(simInterval);
                    btn.innerText = "Connect Hardware";
                    btn.style.background = "var(--primary)";
                    btn.style.color = "#000";
                    hwText.innerText = "STANDBY"; hwText.style.color = "#888";
                    hwDot.style.background = "#555"; hwDot.style.boxShadow = "none";
                    disclaimer.style.opacity = 0;
                    resetData();
                }
            };

            function runSimulationStep() {
                const bpm = Math.floor(Math.random() * (120 - 60) + 60);
                const spo2 = Math.floor(Math.random() * (100 - 94) + 94);
                const temp = (Math.random() * (37.5 - 36.2) + 36.2).toFixed(1);
                state.bpm = bpm; state.spo2 = spo2; state.temp = temp;
                let score = 100;
                if(bpm > 100 || bpm < 50) score -= 20;
                if(spo2 < 95) score -= (95 - spo2) * 5;
                state.healthScore = Math.max(0, score);
                updateUI();
                updateCharts(bpm, spo2, temp);
                generateAIAnalysis(state.healthScore, bpm, spo2);
                updateRobotAppearance(state.healthScore);
            }

            function updateUI() {
                document.getElementById('dash-bpm').innerText = state.bpm;
                document.getElementById('dash-spo2').innerText = state.spo2;
                document.getElementById('dash-temp').innerText = state.temp;
                document.getElementById('val-health').innerText = state.healthScore + "%";
                const hVal = document.getElementById('val-health');
                if(state.healthScore > 80) hVal.style.color = "var(--primary)";
                else if (state.healthScore > 50) hVal.style.color = "var(--warning)";
                else hVal.style.color = "var(--danger)";
            }
            
            function resetData() {
                document.getElementById('dash-bpm').innerText = "--";
                document.getElementById('dash-spo2').innerText = "--";
                document.getElementById('dash-temp').innerText = "--";
                document.getElementById('val-health').innerText = "--";
            }

            function updateRobotAppearance(score) {
                let hex = 0x00F0FF; 
                if (score < 50) hex = 0xff0000;
                else if (score < 80) hex = 0xffaa00;
                else hex = 0x00F0FF;

                const col = new THREE.Color(hex);
                if (eyeL && eyeL.material) eyeL.material.color.lerp(col, 0.2);
                if (eyeR && eyeR.material) eyeR.material.color.lerp(col, 0.2);
            }

            // --- 4. CHARTS & AI ---
            function generateAIAnalysis(score, bpm, spo2) {
                const aiBox = document.getElementById('dashboard-ai-box');
                const aiList = document.getElementById('full-ai-list');
                let mainMsg = ""; let details = [];
                if (score > 85) {
                    mainMsg = `<i class="fas fa-check-circle"></i> <b>OPTIMAL:</b> User is in peak cognitive condition.`;
                    details = ["Heart rate variability is stable.", "Oxygen saturation indicates good lung efficiency.", "Recommendation: Maintain current activity levels."];
                    aiBox.style.borderColor = "var(--success)"; aiBox.style.background = "rgba(16, 185, 129, 0.05)";
                } else if (score > 60) {
                    mainMsg = `<i class="fas fa-exclamation-triangle"></i> <b>WARNING:</b> Mild stress detected.`;
                    details = ["Elevated heart rate suggests physical or mental load.", "Recommendation: Take a 5-minute breathing break."];
                    aiBox.style.borderColor = "var(--warning)"; aiBox.style.background = "rgba(245, 158, 11, 0.05)";
                } else {
                    mainMsg = `<i class="fas fa-skull-crossbones"></i> <b>CRITICAL:</b> Vital signs indicate distress.`;
                    details = ["Tachycardia detected.", "Oxygen levels suboptimal.", "Recommendation: Cease activity immediately."];
                    aiBox.style.borderColor = "var(--danger)"; aiBox.style.background = "rgba(239, 68, 68, 0.05)";
                }
                aiBox.innerHTML = mainMsg;
                if(aiList) {
                    aiList.innerHTML = "";
                    details.forEach(txt => { const li = document.createElement('li'); li.innerHTML = `<i class="fas fa-angle-right" style="color:#555"></i> ${txt}`; aiList.appendChild(li); });
                }
            }

            function initCharts() {
                const commonOptions = { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { grid: { color: '#333' } } }, elements: { point: { radius: 0 } }, animation: false };
                charts.bpm = new Chart(document.getElementById('chart-bpm-detail'), { type: 'line', data: { labels: Array(20).fill(''), datasets: [{ data: Array(20).fill(70), borderColor: '#00F0FF', tension: 0.4 }] }, options: { ...commonOptions, plugins: { title: { display: true, text: 'Real-time Heart Rate' } } } });
                charts.spo2 = new Chart(document.getElementById('chart-spo2-detail'), { type: 'line', data: { labels: Array(20).fill(''), datasets: [{ data: Array(20).fill(98), borderColor: '#10b981', tension: 0.4 }] }, options: { ...commonOptions, plugins: { title: { display: true, text: 'Real-time SpO2' } } } });
                charts.temp = new Chart(document.getElementById('chart-temp-detail'), { type: 'line', data: { labels: Array(20).fill(''), datasets: [{ data: Array(20).fill(36.5), borderColor: '#f59e0b', tension: 0.4 }] }, options: { ...commonOptions, plugins: { title: { display: true, text: 'Real-time Temperature' } } } });
                
                if(document.getElementById('chart-sleep')) new Chart(document.getElementById('chart-sleep'), { type: 'bar', data: { labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'], datasets: [{ label: 'Hours', data: [6.5, 7.0, 5.5, 8.0, 7.5, 9.0, 8.5], backgroundColor: '#7c3aed', borderRadius: 4 }] }, options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { grid: { color: '#333' } } } } });
                if(document.getElementById('chart-stress')) new Chart(document.getElementById('chart-stress'), { type: 'line', data: { labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'], datasets: [{ data: [20, 45, 30, 80, 55, 20, 15], borderColor: '#ef4444', tension: 0.3, fill: true, backgroundColor: 'rgba(239, 68, 68, 0.1)' }] }, options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { grid: { color: '#333' } } } } });
                if(document.getElementById('chart-weight')) new Chart(document.getElementById('chart-weight'), { type: 'line', data: { labels: ['Wk1', 'Wk2', 'Wk3', 'Wk4'], datasets: [{ data: [72, 71.5, 71.0, 70.8], borderColor: '#00F0FF', tension: 0.2 }] }, options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { grid: { color: '#333' } } } } });
            }

            function updateCharts(bpm, spo2, temp) {
                [charts.bpm, charts.spo2, charts.temp].forEach((chart, i) => { if(chart) { const val = [bpm, spo2, temp][i]; const d = chart.data.datasets[0].data; d.shift(); d.push(val); chart.update(); } });
            }
        });
    </script>
</body>
</html>